---
title: Psychobiological Markers of Allostatic Load in Depressed and Non-Depressed
  Mothers and Their Adolescent Offspring Code
author: "Benjamin W Nelson"
date: "10/16/2019"
output:
---

# Set Working Directory_______________________________
```{r}
setwd("~/Desktop/Manuscripts/Allostatic Load in Adolescents and Depressed Mothers")
```


# Load Packages_______________________________________
```{r}
library(psych)
library(lubridate)
library(shiny)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(foreign)
library(ggplotAssist)
library(summarytools)
library(yarrr)
library(plyr)
library(corrplot)
library(tidylog)
library(styler)
library(readxl)
library(tidyr)
library(zoo)
library(magrittr)
library(readr)
library(naniar)
library(car)
library(reshape2)
library(jmv)
library(sjPlot)
library(sjstats)
library(dabestr)
```

#Self-Report and Telomere Analyses
##Import Dataset
```{r}
subject_id <- read_csv("~/Desktop/Manuscripts/Allostatic Load in Adolescents and Depressed Mothers/subject ids.csv")

self_report_data <- read_csv("~/Desktop/Manuscripts/Allostatic Load in Adolescents and Depressed Mothers/self_report_data_cleaned_winsorized.csv")
self_report_data <- self_report_data %>% #drop column
  select(-c(X1))

telomere_data <- read_csv("~/Desktop/Manuscripts/Allostatic Load in Adolescents and Depressed Mothers/telomere_cleaned.csv")
telomere_data <- telomere_data %>% #drop column
  select(-c(X1))

#Make column for mother telomere and adolescent telomere
telomere_data <- spread(telomere_data, identifier, telomere_length)

#Rename columns
names(telomere_data) <- c("subject_id", "adolescent_telomere", "mother_telomere")

subject_id$subject_id <- as.numeric(subject_id$subject_id)
self_report_data$subject_id <- as.numeric(self_report_data$subject_id)
telomere_data$subject_id <- as.numeric(telomere_data$subject_id)

str(self_report_data$subject_id)
str(telomere_data$subject_id)
str(subject_id$subject_id)
```

##Merge Datasets
```{r}
data_merge1 <- left_join(subject_id, self_report_data, by = c("subject_id"))

data_merge2 <- left_join(data_merge1, telomere_data, by = c("subject_id"))

data <- data_merge2
```

##Name Group
```{r}
data$group <- factor(data$group,
levels = c(1,2),
labels = c("High Risk", "Low Risk")) 
```

##Check Structure
```{r}
str(data)

# Change variables to factor
cols_fac <- c("group", 
              "adol_sick_last_24", 
              "mother_sick_last_24", 
              "adol_gum_bleading", 
              "mother_gum_bleading", 
              "bio_sex_mother", 
              "gender_mother", 
              "rel_status_mother", 
              "ethnicity_mother", 
              "edu_level", 
              "income", 
              "ethnicity_adol", 
              "rel_to_adol", 
              "race_mother", 
              "race_adol", 
              "bio_sex_adol", 
              "gender_adol", 
              "employment"
              )
data[, cols_fac] %<>%
  lapply(function(x) as.factor(as.character(x)))

str(data)
```


##View Missing Data
```{r}
miss_var_summary(data)

vis_miss(data)
```

##Adolescent Baseline Analyses############################################


### 1) Total Mental Health Symptoms

Get means and sd
```{r}
data %>%
  group_by(group, na.rm = TRUE) %>%
  summarize(
    mean = mean(ysr_tot_adol_report, na.rm = TRUE),
    sd = sd(ysr_tot_adol_report, na.rm = TRUE)
  )
```

A) Check Model Assumptions
```{r}
# Check for homogeneity of variance
leveneTest(ysr_tot_adol_report ~ group, center = mean, data = data)
```

B) Unadjusted Model
```{r}
# ANOVA
# Simple T-Test
t.test(ysr_tot_adol_report ~ group, data = data)

# ANCOVA
tot_sxs_unadjusted <- aov(ysr_tot_adol_report ~ group, data = data)
summary(tot_sxs_unadjusted)
cohens_f(tot_sxs_unadjusted)
anova_stats(tot_sxs_unadjusted)
AIC(tot_sxs_unadjusted)
BIC(tot_sxs_unadjusted)


# Check residuals for normality
tot_sxs_residuals_unadjusted <- resid(tot_sxs_unadjusted)
shapiro.test(tot_sxs_residuals_unadjusted)

# Plot
pirateplot(
  formula = ysr_tot_adol_report ~ group, # This lets you see the relationship between a categorical and continuous variables
  data = data,
  ylab = "Mental Health Symptoms",
  theme = 1, pal = "google"
)

#Density Plot
p <- data %>%
  mutate(group = group) %>%
  ggplot(aes(ysr_tot_adol_report, fill = group))
p + geom_density(alpha = 0.6)

#Difference Plot
cbcl_graph <- data %>%
  select(subject_id, group, ysr_tot_adol_report)

cbcl_graph <- na.omit(cbcl_graph)
mean_difference <- dabest(cbcl_graph, group, ysr_tot_adol_report,
       idx = c("Low Risk", "High Risk"),
       paired = FALSE)

plot(mean_difference)
```

C) Adjusted Model
```{r}
# ANCOVA
tot_sxs_adjusted <- aov(ysr_tot_adol_report ~ group + age_adol + bio_sex_adol, data = data)
summary(tot_sxs_adjusted)
cohens_f(tot_sxs_adjusted)
anova_stats(tot_sxs_adjusted)
AIC(tot_sxs_adjusted)
BIC(tot_sxs_adjusted)

ysr.model.comparison <- stats::anova(tot_sxs_unadjusted, tot_sxs_adjusted)
ysr.model.comparison

# Check residuals for normality
tot_sxs_residuals_adjusted <- resid(tot_sxs_adjusted)
shapiro.test(tot_sxs_residuals_adjusted)
```

#### 1a) Internalizing Mental Health Symptoms

Get means and sd
```{r}
data %>%
  group_by(group, na.rm = TRUE) %>%
  summarize(
    mean = mean(ysr_int_adol_report, na.rm = TRUE),
    sd = sd(ysr_int_adol_report, na.rm = TRUE)
  )
```

A) Check Model Assumptions
```{r}
# Check for homogeneity of variance
leveneTest(ysr_int_adol_report ~ group, center = mean, data = data)
```

B) Unadjusted Model
```{r}
# ANOVA
# Simple T-Test
t.test(ysr_int_adol_report ~ group, data = data)

# ANCOVA
int_sxs_unadjusted <- aov(ysr_int_adol_report ~ group, data = data)
summary(int_sxs_unadjusted)
cohens_f(int_sxs_unadjusted)
anova_stats(int_sxs_unadjusted)
AIC(int_sxs_unadjusted)
BIC(int_sxs_unadjusted)

# Check residuals for normality
int_sxs_residuals_unadjusted <- resid(int_sxs_unadjusted)
shapiro.test(int_sxs_residuals_unadjusted)

# Plot
pirateplot(
  formula = ysr_int_adol_report ~ group, # This lets you see the relationship between a categorical and continuous variables
  data = data,
  ylab = "Internalizing Mental Health Symptoms",
  theme = 1, pal = "google"
)

#Density Plot
p <- data %>%
  mutate(group = group) %>%
  ggplot(aes(ysr_int_adol_report, fill = group))
p + geom_density(alpha = 0.6)

#Difference Plot
cbcl_graph <- data %>%
  select(subject_id, group, ysr_int_adol_report)

cbcl_graph <- na.omit(cbcl_graph)
mean_difference <- dabest(cbcl_graph, group, ysr_int_adol_report,
                          idx = c("Low Risk", "High Risk"),
                          paired = FALSE)

plot(mean_difference)
```

C) Adjusted Model
```{r}
# ANCOVA
int_sxs_adjusted <- aov(ysr_int_adol_report ~ group + age_adol + bio_sex_adol, data = data)
summary(int_sxs_adjusted)
cohens_f(int_sxs_adjusted)
anova_stats(int_sxs_adjusted)
AIC(int_sxs_adjusted)
BIC(int_sxs_adjusted)

ysr.model.comparison <- stats::anova(int_sxs_unadjusted, int_sxs_adjusted)
ysr.model.comparison

# Check residuals for normality
int_sxs_residuals_adjusted <- resid(int_sxs_adjusted)
shapiro.test(int_sxs_residuals_adjusted)
```

#### 1b) Externalizing Mental Health Symptoms

Get means and sd
```{r}
data %>%
  group_by(group, na.rm = TRUE) %>%
  summarize(
    mean = mean(ysr_ext_adol_report, na.rm = TRUE),
    sd = sd(ysr_ext_adol_report, na.rm = TRUE)
  )
```

A) Check Model Assumptions
```{r}
# Check for homogeneity of variance
leveneTest(ysr_ext_adol_report ~ group, center = mean, data = data)
```

B) Unadjusted Model
```{r}
# ANOVA
# Simple T-Test
t.test(ysr_ext_adol_report ~ group, data = data)

# ANCOVA
ext_sxs_unadjusted <- aov(ysr_ext_adol_report ~ group, data = data)
summary(ext_sxs_unadjusted)
cohens_f(ext_sxs_unadjusted)
anova_stats(ext_sxs_unadjusted)
AIC(ext_sxs_unadjusted)
BIC(ext_sxs_unadjusted)

# Check residuals for normality
ext_sxs_residuals_unadjusted <- resid(ext_sxs_unadjusted)
shapiro.test(ext_sxs_residuals_unadjusted)

# Plot
pirateplot(
  formula = ysr_ext_adol_report ~ group, # This lets you see the relationship between a categorical and continuous variables
  data = data,
  ylab = "Externalizing Mental Health Symptoms",
  theme = 1, pal = "google"
)

#Density Plot
p <- data %>%
  mutate(group = group) %>%
  ggplot(aes(ysr_ext_adol_report, fill = group))
p + geom_density(alpha = 0.6)

#Difference Plot
cbcl_graph <- data %>%
  select(subject_id, group, ysr_ext_adol_report)

cbcl_graph <- na.omit(cbcl_graph)
mean_difference <- dabest(cbcl_graph, group, ysr_ext_adol_report,
                          idx = c("Low Risk", "High Risk"),
                          paired = FALSE)

plot(mean_difference)
```

C) Adjusted Model
```{r}
# ANCOVA
ext_sxs_adjusted <- aov(ysr_ext_adol_report ~ group + age_adol + bio_sex_adol, data = data)
summary(ext_sxs_adjusted)
cohens_f(ext_sxs_adjusted)
anova_stats(ext_sxs_adjusted)
AIC(ext_sxs_adjusted)
BIC(ext_sxs_adjusted)

ysr.model.comparison <- stats::anova(ext_sxs_unadjusted, ext_sxs_adjusted)
ysr.model.comparison

# Check residuals for normality
ext_sxs_residuals_adjusted <- resid(ext_sxs_adjusted)
shapiro.test(ext_sxs_residuals_adjusted)
```

###2) Telomere Length
Get means and sd
```{r}
data %>%
  group_by(group, na.rm = TRUE) %>%
  summarize(
    mean = mean(adolescent_telomere, na.rm = TRUE),
    sd = sd(adolescent_telomere, na.rm = TRUE)
  )
```

A) Check Model Assumptions
```{r}
# Check for homogeneity of variance
leveneTest(adolescent_telomere ~ group, center = mean, data = data)
```

B) Unadjusted Model
```{r}
# ANOVA
# Simple T-Test
t.test(adolescent_telomere ~ group, data = data)

# ANCOVA
adol_telomere_unadjusted <- aov(adolescent_telomere ~ group, data = data)
summary(adol_telomere_unadjusted)
cohens_f(adol_telomere_unadjusted)
anova_stats(adol_telomere_unadjusted)
AIC(adol_telomere_unadjusted)
BIC(adol_telomere_unadjusted)

# Check residuals for normality
adol_telomere_residuals_unadjusted <- resid(adol_telomere_unadjusted)
shapiro.test(adol_telomere_residuals_unadjusted)

# Plot
pirateplot(
  formula = adolescent_telomere ~ group, # This lets you see the relationship between a categorical and continuous variables
  data = data,
  ylab = "Adolescent Telomere Length",
  theme = 1, pal = "google"
)

#Density Plot
p <- data %>%
  mutate(group = group) %>%
  ggplot(aes(adolescent_telomere, fill = group))
p + geom_density(alpha = 0.6)

#Difference Plot
adol_telomere_graph <- data %>%
  select(subject_id, group, adolescent_telomere)

adol_telomere_graph <- na.omit(adol_telomere_graph)
mean_difference <- dabest(adol_telomere_graph, group, adolescent_telomere,
       idx = c("High Risk", "Low Risk"),
       paired = FALSE)

plot(mean_difference)
```

C) Adjusted Model 1
```{r}
# ANCOVA
adol_telomere_adjusted <- aov(adolescent_telomere ~ group + age_adol + bio_sex_adol, data = data)
summary(adol_telomere_adjusted)
cohens_f(adol_telomere_adjusted)
anova_stats(adol_telomere_adjusted)
AIC(adol_telomere_adjusted)
BIC(adol_telomere_adjusted)

adol.telomere.model.comparison <- stats::anova(adol_telomere_unadjusted, adol_telomere_adjusted)
adol.telomere.model.comparison

# Check residuals for normality
adol_telomere_residuals_adjusted <- resid(adol_telomere_adjusted)
shapiro.test(adol_telomere_residuals_adjusted)
```

D) Adjusted Model 2
```{r}
# ANCOVA
adol_telomere_adjusted2 <- aov(adolescent_telomere ~ group + age_adol + bio_sex_adol + ysr_tot_adol_report, data = data)
summary(adol_telomere_adjusted2)
cohens_f(adol_telomere_adjusted2)
anova_stats(adol_telomere_adjusted2)
AIC(adol_telomere_adjusted2)
BIC(adol_telomere_adjusted2)

adol.telomere.model.comparison2 <- stats::anova(adol_telomere_adjusted, adol_telomere_adjusted2)
adol.telomere.model.comparison2

# Check residuals for normality
adol_telomere_residuals_adjusted2 <- resid(adol_telomere_adjusted2)
shapiro.test(adol_telomere_residuals_adjusted2)
```







##Mother Baseline Analyses############################################

### 1) Depressive Symptoms
A) Check Model Assumptions
```{r}
# Check for homogeneity of variance
leveneTest(phq9_mother ~ group, center = mean, data = data)
```

B) Unadjusted Model
```{r}
# ANOVA
# Simple T-Test
t.test(phq9_mother ~ group, data = data)

# ANCOVA
phq_unadjusted <- aov(phq9_mother ~ group, data = data)
summary(phq_unadjusted)
cohens_f(phq_unadjusted)
anova_stats(phq_unadjusted)


# Check residuals for normality
phq_residuals_unadjusted <- resid(phq_unadjusted)
shapiro.test(phq_residuals_unadjusted)

# Plot
pirateplot(
  formula = phq9_mother ~ group, # This lets you see the relationship between a categorical and continuous variables
  data = data,
  ylab = "PHQ-9",
  theme = 1, pal = "google"
)

#Density Plot
p <- data %>%
  mutate(group = group) %>%
  ggplot(aes(phq9_mother, fill = group))
p + geom_density(alpha = 0.6)

#Difference Plot
phq_graph <- data %>%
  select(subject_id, group, phq9_mother)

phq_graph <- na.omit(phq_graph)
mean_difference <- dabest(phq_graph, group, phq9_mother,
       idx = c("High Risk", "Low Risk"),
       paired = FALSE)

plot(mean_difference)
```

C) Adjusted Model
```{r}
# ANCOVA
phq_adjusted <- aov(phq9_mother ~ group + age_mother, data = data)
summary(phq_adjusted)
cohens_f(phq_adjusted)
anova_stats(phq_adjusted)

phq.model.comparison <- stats::anova(phq_unadjusted, phq_adjusted)
phq.model.comparison

# Check residuals for normality
phq_residuals_adjusted <- resid(phq_adjusted)
shapiro.test(phq_residuals_adjusted)
```

###2) Telomere Length
Get means and sd
```{r}
data %>%
  group_by(group, na.rm = TRUE) %>%
  summarize(
    mean = mean(mother_telomere, na.rm = TRUE),
    sd = sd(mother_telomere, na.rm = TRUE)
  )
```

A) Check Model Assumptions
```{r}
# Check for homogeneity of variance
leveneTest(mother_telomere ~ group, center = mean, data = data)
```

B) Unadjusted Model
```{r}
# ANOVA
# Simple T-Test
t.test(mother_telomere ~ group, data = data)

# ANCOVA
mother_telomere_unadjusted <- aov(mother_telomere ~ group, data = data)
summary(mother_telomere_unadjusted)
cohens_f(mother_telomere_unadjusted)
anova_stats(mother_telomere_unadjusted)
AIC(mother_telomere_unadjusted)
BIC(mother_telomere_unadjusted)

# Check residuals for normality
mother_telomere_residuals_unadjusted <- resid(mother_telomere_unadjusted)
shapiro.test(mother_telomere_residuals_unadjusted)

# Plot
pirateplot(
  formula = mother_telomere ~ group, # This lets you see the relationship between a categorical and continuous variables
  data = data,
  ylab = "Mother Telomere Length",
  theme = 1, pal = "google"
)

#Density Plot
p <- data %>%
  mutate(group = group) %>%
  ggplot(aes(mother_telomere, fill = group))
p + geom_density(alpha = 0.6)

#Difference Plot
mother_telomere_graph <- data %>%
  select(subject_id, group, mother_telomere)

mother_telomere_graph <- na.omit(mother_telomere_graph)
mean_difference <- dabest(mother_telomere_graph, group, mother_telomere,
                          idx = c("High Risk", "Low Risk"),
                          paired = FALSE)

plot(mean_difference)
```

C) Adjusted Model
```{r}
# ANCOVA
mother_telomere_adjusted <- aov(mother_telomere ~ group + age_mother, data = data)
summary(mother_telomere_adjusted)
cohens_f(mother_telomere_adjusted)
anova_stats(mother_telomere_adjusted)
AIC(mother_telomere_adjusted)
BIC(mother_telomere_adjusted)

mother.telomere.model.comparison <- stats::anova(mother_telomere_unadjusted, mother_telomere_adjusted)
mother.telomere.model.comparison

# Check residuals for normality
mother_telomere_residuals_adjusted <- resid(mother_telomere_adjusted)
shapiro.test(mother_telomere_residuals_adjusted)
```

#Inflammation Analyses

##Import Dataset
```{r}
subject_id <- read_csv("~/Desktop/Manuscripts/Allostatic Load in Adolescents and Depressed Mothers/subject ids.csv")

inflammation_data <- read_csv("~/Desktop/Manuscripts/Allostatic Load in Adolescents and Depressed Mothers/inflammation_cleaned.csv")

adolescent_med_data <- read_csv("~/Desktop/Manuscripts/Allostatic Load in Adolescents and Depressed Mothers/adolescent_med_data_cleaned.csv")

adolescent_med_data <- adolescent_med_data %>% 
  select(-X1)

mother_med_data <- read_csv("~/Desktop/Manuscripts/Allostatic Load in Adolescents and Depressed Mothers/mother_med_data_cleaned.csv")

mother_med_data <- mother_med_data %>% 
  select(-X1)

group_data <- read_csv("~/Desktop/Manuscripts/Allostatic Load in Adolescents and Depressed Mothers/group_data.csv")
group_data <- group_data %>% 
  select(-X1)

immune_covariates <- read_csv("~/Desktop/Manuscripts/Allostatic Load in Adolescents and Depressed Mothers/immune covariates.csv")

subject_id$subject_id <- as.numeric(subject_id$subject_id)
inflammation_data$subject_id <- as.numeric(inflammation_data$subject_id)
adolescent_med_data$subject_id <- as.numeric(adolescent_med_data$subject_id)
mother_med_data$subject_id <- as.numeric(mother_med_data$subject_id)
group_data$subject_id <- as.numeric(group_data$subject_id)
immune_covariates$subject_id <- as.numeric(immune_covariates$subject_id)


inflammation_adolescent <- inflammation_data %>% 
  select(subject_id, mean_crp_conc_adolescent, crp_log_adolescent)

inflammation_mother <- inflammation_data %>% 
  select(subject_id, mean_crp_conc_mother, crp_log_mother)

#Import self report and save immune covariates
self_report_data <- read_csv("self_report_cleaned.csv")

covariates <- self_report_data %>% 
  select(subject_id, ysr_tot_adol_report, age_mother, age_adol, bio_sex_mother, bio_sex_adol, gender_mother, gender_adol, race_mother, race_adol, ethnicity_mother, ethnicity_adol, mother_sick_last_24, adol_sick_last_24, mother_gum_bleading, adol_gum_bleading, mother_wake_time, adol_wake_time, mother_bmi, adol_bmi, mother_temp, adol_temp)

write.csv(covariates, file = "immune covariates.csv")
```

##Merge Adolescent Datasets
```{r}
adolescent_data <- left_join(subject_id, group_data, by = c("subject_id"))

adolescent_data <- left_join(adolescent_data, inflammation_adolescent, by = c("subject_id"))

adolescent_data <- left_join(adolescent_data, adolescent_med_data, by = c("subject_id"))

adolescent_data <- left_join(adolescent_data, immune_covariates, by = c("subject_id"))
```

##Name Adolescent Group
```{r}
adolescent_data$group <- factor(adolescent_data$group,
levels = c(1,2),
labels = c("High Risk", "Low Risk")) 
```

##Merge Mother Datasets
```{r}
mother_data <- left_join(subject_id, group_data, by = c("subject_id"))

mother_data <- left_join(mother_data, inflammation_mother, by = c("subject_id"))

mother_data <- left_join(mother_data, mother_med_data, by = c("subject_id"))

mother_data <- left_join(mother_data, immune_covariates, by = c("subject_id"))
```

##Name Mother Group
```{r}
mother_data$group <- factor(mother_data$group,
levels = c(1,2),
labels = c("Depressed", "Non-Depressed")) 
```

Create separate dataset for adolescent and mother

##Check Structure
```{r}
# Change adolescent variables to factor
cols_fac <- c("group", 
              "birth_control_med_today",
              "birth_control_med_past_24hrs",
              "nsaids_med_today",
              "nsaids_med_past_24hrs",
              "antibiotic_antivirals_med_today",
              "antibiotic_antivirals_med_past_24hrs",
              "steroids_med_today",
              "steroids_med_past_24hrs",
              "hormones_med_today",
              "hormones_med_past_24hrs",
              "antihistamines_med_today",
              "antihistamines_med_past_24hrs",
              "adrenergic_bronchodilators_med_today",
              "adrenergic_bronchodilators_med_past_24hrs",
              "ethnicity_adol",
              "race_adol",
              "bio_sex_adol",
              "gender_adol",
              "adol_gum_bleading",
              "adol_sick_last_24"
              )
adolescent_data[, cols_fac] %<>%
  lapply(function(x) as.factor(as.character(x)))

#Change adolescent variables to factor
cols_fac <- c("group", 
              "birth_control_med_today",
              "birth_control_med_past_24hrs",
              "nsaids_med_today",
              "nsaids_med_past_24hrs",
              "antibiotic_antivirals_med_today",
              "antibiotic_antivirals_med_past_24hrs",
              "steroids_med_today",
              "steroids_med_past_24hrs",
              "hormones_med_today",
              "hormones_med_past_24hrs",
              "antihistamines_med_today",
              "antihistamines_med_past_24hrs",
              "adrenergic_bronchodilators_med_today",
              "adrenergic_bronchodilators_med_past_24hrs",
              "ethnicity_mother",
              "race_mother",
              "bio_sex_mother",
              "gender_mother",
              "mother_gum_bleading",
              "mother_sick_last_24"
              )
mother_data[, cols_fac] %<>%
  lapply(function(x) as.factor(as.character(x)))
```


##Adolescent Baseline Analyses############################################

###Inflammation

Get means and sd
```{r}
describe(adolescent_data$crp_log_adolescent)

adolescent_data %>%
  group_by(group, na.rm = TRUE) %>%
  summarize(
    mean = mean(crp_log_adolescent, na.rm = TRUE),
    sd = sd(crp_log_adolescent, na.rm = TRUE)
  )
```

A) Check Model Assumptions
```{r}
# Check for homogeneity of variance
car::leveneTest(crp_log_adolescent ~ group, center = mean, data = adolescent_data)
```

B) Unadjusted Model
```{r}
# ANOVA
# Simple T-Test
t.test(crp_log_adolescent ~ group, data = adolescent_data)

# ANCOVA
crp_unadjusted <- aov(crp_log_adolescent ~ group, data = adolescent_data)
summary(crp_unadjusted)
cohens_f(crp_unadjusted)
anova_stats(crp_unadjusted)

# Check residuals for normality
crp_residuals_unadjusted <- resid(crp_unadjusted)
shapiro.test(crp_residuals_unadjusted)

# Plot
pirateplot(
  formula = crp_log_adolescent ~ group, # This lets you see the relationship between a categorical and continuous variables
  data = adolescent_data,
  ylab = "CRP log",
  theme = 1, pal = "google"
)

p <- adolescent_data %>%
  mutate(group = group) %>%
  ggplot(aes(crp_log_adolescent, fill = group))
p + geom_density(alpha = 0.6)

crp_graph <- adolescent_data %>%
  select(subject_id, group, crp_log_adolescent)

crp_graph <- na.omit(crp_graph)

mean_difference <- dabestr::dabest(crp_graph, group, crp_log_adolescent,
       idx = c("High Risk", "Low Risk"),
       paired = FALSE)

plot(mean_difference)
```

C) Adjusted Model 1
```{r}
#See which medication data covaries with adolescent inflammation
##BMI
cor.test(adolescent_data$crp_log_adolescent, adolescent_data$adol_bmi, alternative = "two.sided", method = "pearson", conf.level = 0.95) #sig
##Temp
cor.test(adolescent_data$crp_log_adolescent, adolescent_data$adol_temp, alternative = "two.sided", method = "pearson", conf.level = 0.95) #not sig
#Birth Control
chisq.test(adolescent_data$mean_crp_conc_adolescent, adolescent_data$birth_control_med_past_24hrs) #not sig
#NSAIDs
chisq.test(adolescent_data$mean_crp_conc_adolescent, adolescent_data$nsaids_med_today) #not sig
#Steroids
chisq.test(adolescent_data$mean_crp_conc_adolescent, adolescent_data$steroids_med_past_24hrs) #not sig
#Hormones
chisq.test(adolescent_data$mean_crp_conc_adolescent, adolescent_data$hormones_med_past_24hrs) #not sig
#Antihistamines
chisq.test(adolescent_data$mean_crp_conc_adolescent, adolescent_data$antidepressants_med_today) #not sig
#Adolescent Sick
chisq.test(adolescent_data$mean_crp_conc_adolescent, adolescent_data$adol_sick_last_24) #not sig
#Gum Bleeding
chisq.test(adolescent_data$mean_crp_conc_adolescent, adolescent_data$adol_gum_bleading) #not sig

# ANCOVA
crp_adjusted <- aov(crp_log_adolescent ~ group + age_adol + bio_sex_adol + adol_bmi, data = adolescent_data)
summary(crp_adjusted)
cohens_f(crp_adjusted)
anova_stats(crp_adjusted)

stats::anova(crp_unadjusted, crp_adjusted)

# Check residuals for normality
crp_residuals_adjusted <- resid(crp_adjusted)
shapiro.test(crp_residuals_adjusted)
```

D) Adjusted Model 2
```{r}
# ANCOVA
crp_adjusted2 <- aov(crp_log_adolescent ~ group + age_adol + bio_sex_adol + adol_bmi + ysr_tot_adol_report, data = adolescent_data)
summary(crp_adjusted2)
cohens_f(crp_adjusted2)
anova_stats(crp_adjusted2)

stats::anova(crp_adjusted, crp_adjusted2)

# Check residuals for normality
crp_residuals_adjusted2 <- resid(crp_adjusted2)
shapiro.test(crp_residuals_adjusted2)
```

##Mother Baseline Analyses############################################

###Inflammation

Get means and sd
```{r}
describe(mother_data$crp_log_mother)

mother_data %>%
  group_by(group, na.rm = TRUE) %>%
  summarize(
    mean = mean(crp_log_mother, na.rm = TRUE),
    sd = sd(crp_log_mother, na.rm = TRUE)
  )
```

A) Check Model Assumptions
```{r}
# Check for homogeneity of variance
car::leveneTest(crp_log_mother ~ group, center = mean, data = mother_data)
```

B) Unadjusted Model
```{r}
# ANOVA
# Simple T-Test
t.test(crp_log_mother ~ group, data = mother_data)

# ANCOVA
crp_unadjusted <- aov(crp_log_mother ~ group, data = mother_data)
summary(crp_unadjusted)
cohens_f(crp_unadjusted)
anova_stats(crp_unadjusted)

# Check residuals for normality
crp_residuals_unadjusted <- resid(crp_unadjusted)
shapiro.test(crp_residuals_unadjusted)

# Plot
pirateplot(
  formula = crp_log_mother ~ group, # This lets you see the relationship between a categorical and continuous variables
  data = mother_data,
  ylab = "CRP log",
  theme = 1, pal = "google"
)

p <- mother_data %>%
  mutate(group = group) %>%
  ggplot(aes(crp_log_mother, fill = group))
p + geom_density(alpha = 0.6)

crp_graph <- mother_data %>%
  select(subject_id, group, crp_log_mother)

crp_graph <- na.omit(crp_graph)

mean_difference <- dabestr::dabest(crp_graph, group, crp_log_mother,
                                   idx = c("Depressed", "Non-Depressed"),
                                   paired = FALSE)

plot(mean_difference)
```

C) Adjusted Model 1
```{r}
#See which medication data covaries with mother inflammation
##BMI
cor.test(mother_data$crp_log_mother, mother_data$mother_bmi, alternative = "two.sided", method = "pearson", conf.level = 0.95) #sig
##Temp
cor.test(mother_data$crp_log_mother, mother_data$mother_temp, alternative = "two.sided", method = "pearson", conf.level = 0.95) #not sig
#Birth Control
chisq.test(mother_data$mean_crp_conc_mother, mother_data$birth_control_med_past_24hrs) #not sig
#NSAIDs
chisq.test(mother_data$mean_crp_conc_mother, mother_data$nsaids_med_today) #not sig
#Steroids
chisq.test(mother_data$mean_crp_conc_mother, mother_data$steroids_med_past_24hrs) #not sig
#Hormones
chisq.test(mother_data$mean_crp_conc_mother, mother_data$hormones_med_past_24hrs) #not sig
#Antihistamines
chisq.test(mother_data$mean_crp_conc_mother, mother_data$antidepressants_med_today) #not sig
#mother Sick
chisq.test(mother_data$mean_crp_conc_mother, mother_data$adol_sick_last_24) #not sig
#Gum Bleeding
chisq.test(mother_data$mean_crp_conc_mother, mother_data$adol_gum_bleading) #not sig

# ANCOVA
crp_adjusted <- aov(crp_log_mother ~ group + age_mother + mother_bmi, data = mother_data)
summary(crp_adjusted)
cohens_f(crp_adjusted)
anova_stats(crp_adjusted)

stats::anova(crp_unadjusted, crp_adjusted)

# Check residuals for normality
crp_residuals_adjusted <- resid(crp_adjusted)
shapiro.test(crp_residuals_adjusted)
```

#Physiology Analyses


##Import Dataset
```{r}
#Import Data
physio_data <- read_csv("~/Desktop/Manuscripts/Allostatic Load in Adolescents and Depressed Mothers/physio_data_active_cleaned_winsorized_final.csv")
physio_data <- physio_data %>% #drop column
  select(-c(X1))

str(physio_data$subject_id)

adolescent_med_data <- read_csv("~/Desktop/Manuscripts/Allostatic Load in Adolescents and Depressed Mothers/adolescent_med_data_cleaned.csv")

adolescent_med_data <- adolescent_med_data %>% 
  select(-X1)

mother_med_data <- read_csv("~/Desktop/Manuscripts/Allostatic Load in Adolescents and Depressed Mothers/mother_med_data_cleaned.csv")

mother_med_data <- mother_med_data %>% 
  select(-X1)

self_report_data <- read_csv("~/Desktop/Manuscripts/Allostatic Load in Adolescents and Depressed Mothers/self_report_cleaned.csv")
```

##Check Structure
```{r}
str(physio_data)

# Change variables to factor
cols_fac <- c("group", "final_status", "identifier", "impedance", "respiration", "skin_conductance")
physio_data[, cols_fac] %<>%
  lapply(function(x) as.factor(as.character(x)))

```

##Make Adolescent and Parent Datasets
```{r}
adolescent_data <- physio_data %>% 
  filter(identifier == "Adolescent" & Family_Interaction == "quiet_baseline")

mother_data <- physio_data %>% 
  filter(identifier == "Mother" & Family_Interaction == "quiet_baseline")
```




##Merge Datasets
```{r}
adolescent_data <- left_join(adolescent_data, adolescent_med_data, by = c("subject_id"))
adolescent_data <- left_join(adolescent_data, self_report_data, by = c("subject_id"))

mother_data <- left_join(mother_data, mother_med_data, by = c("subject_id"))
mother_data <- left_join(mother_data, self_report_data, by = c("subject_id"))

#Clean Merged Datasets
adolescent_data <- adolescent_data %>% 
  select(-group.y, -X1)

mother_data <- mother_data %>% 
  select(-group.y)

#Change Group Name
adolescent_data <- adolescent_data %>% 
dplyr::rename(group = group.x)

mother_data <- mother_data %>% 
dplyr::rename(group = group.x)

```

##Check Structure
```{r}
# Change variables to factor
cols_fac <- c("group", 
              "Family_Interaction",
              "impedance",
              "respiration",
              "skin_conductance",
              "rel_status_mother",
              "ethnicity_mother",
              "ethnicity_adol",
              "edu_level",
              "income",
              "race_mother",
              "rel_to_adol",
              "bio_sex_adol",
              "gender_mother",
              "gender_adol",
              "adol_sick_last_24", 
              "mother_sick_last_24", 
              "adol_gum_bleading", 
              "mother_gum_bleading", 
              "employment",
              "stimulants_med_today",
              "stimulants_med_past_24hrs",
              "anxiolytics_med_today",
              "birth_control_med_past_24hrs",
              "nsaids_med_today",
              "antibiotic_antivirals_med_past_24hrs",
              "steroids_med_past_24hrs",
              "hormones_med_past_24hrs",
              "antihistamines_med_today"
              )
adolescent_data[, cols_fac] %<>%
  lapply(function(x) as.factor(as.character(x)))

cols_fac <- c("group", 
              "Family_Interaction",
              "impedance",
              "respiration",
              "skin_conductance",
              "rel_status_mother",
              "ethnicity_mother",
              "ethnicity_adol",
              "edu_level",
              "income",
              "race_mother",
              "rel_to_adol",
              "bio_sex_adol",
              "gender_mother",
              "gender_adol",
              "adol_sick_last_24", 
              "mother_sick_last_24", 
              "adol_gum_bleading", 
              "mother_gum_bleading", 
              "employment",
              "stimulants_med_today",
              "stimulants_med_past_24hrs",
              "anxiolytics_med_today",
              "birth_control_med_past_24hrs",
              "nsaids_med_today",
              "antibiotic_antivirals_med_past_24hrs",
              "steroids_med_past_24hrs",
              "blood_pressure_med_past_24hrs",
              "blood_pressure_med_today",
              "hormones_med_past_24hrs",
              "antihistamines_med_today",
              "pseudoephedrine_med_today",
              "acetaminophen_med_today",
              "statin_med_past_24hrs",
              "immunosupressant_med_past_24hrs"
              )
mother_data[, cols_fac] %<>%
  lapply(function(x) as.factor(as.character(x)))
```


##View Missing Data
```{r}
miss_var_summary(adolescent_data)

miss_var_summary(mother_data)

vis_miss(adolescent_data)
vis_miss(mother_data)

```

##Adolescent Baseline Analyses############################################

### 1) Resting Heart Rate

Get means and sd
```{r}
describe(adolescent_data$Average_HR_bpm)
describe(adolescent_data$Average_HR_bpm_windsorized)

adolescent_data %>%
  group_by(group, na.rm = TRUE) %>%
  summarize(
    mean = mean(Average_HR_bpm_windsorized, na.rm = TRUE),
    sd = sd(Average_HR_bpm_windsorized, na.rm = TRUE)
  )
```

A) Check Model Assumptions
```{r}
# Check for homogeneity of variance
car::leveneTest(Average_HR_bpm_windsorized ~ group, center = mean, data = adolescent_data)
```

B) Unadjusted Model
```{r}
# ANOVA
# Simple T-Test
t.test(Average_HR_bpm_windsorized ~ group, data = adolescent_data)

# ANCOVA
heart_rate_unadjusted <- aov(Average_HR_bpm_windsorized ~ group, data = adolescent_data)
summary(heart_rate_unadjusted)
stats::AIC(heart_rate_unadjusted)
stats::BIC(heart_rate_unadjusted)
cohens_f(heart_rate_unadjusted)
anova_stats(heart_rate_unadjusted)

# Check residuals for normality
heart_rate_residuals_unadjusted <- resid(heart_rate_unadjusted)
shapiro.test(heart_rate_residuals_unadjusted)

# Plot
pirateplot(
  formula = Average_HR_bpm_windsorized ~ group, # This lets you see the relationship between a categorical and continuous variables
  data = adolescent_data,
  ylab = "Resting Heart Rate",
  theme = 1, pal = "google"
)

p <- adolescent_data %>%
  mutate(group = group) %>%
  ggplot(aes(Average_HR_bpm_windsorized, fill = group))
p + geom_density(alpha = 0.6)

hr_graph <- adolescent_data %>%
  select(subject_id, group, Average_HR_bpm_windsorized)

hr_graph <- na.omit(hr_graph)

mean_difference <- dabestr::dabest(hr_graph, group, Average_HR_bpm_windsorized,
       idx = c("Depressed", "Non-Depressed"),
       paired = FALSE)

plot(mean_difference)
```

C) Adjusted Model 1
```{r}
# ANCOVA
heart_rate_adjusted <- aov(Average_HR_bpm_windsorized ~ group + age_adol + bio_sex_adol + stimulants_med_today, data = adolescent_data)
summary(heart_rate_adjusted)
stats::AIC(heart_rate_unadjusted, heart_rate_adjusted)
stats::BIC(heart_rate_unadjusted, heart_rate_adjusted)
cohens_f(heart_rate_adjusted)
anova_stats(heart_rate_adjusted)

stats::anova(heart_rate_unadjusted, heart_rate_adjusted)

# Check residuals for normality
heart_rate_residuals_adjusted <- resid(heart_rate_adjusted)
shapiro.test(heart_rate_residuals_adjusted)
```

D) Adjusted Model 2
```{r}
# ANCOVA
heart_rate_adjusted2 <- aov(Average_HR_bpm_windsorized ~ group + age_adol + bio_sex_adol + stimulants_med_today + ysr_tot_adol_report, data = adolescent_data)
summary(heart_rate_adjusted2)
summary.aov(heart_rate_adjusted2)
stats::AIC(heart_rate_adjusted, heart_rate_adjusted2)
stats::BIC(heart_rate_adjusted, heart_rate_adjusted2)
cohens_f(heart_rate_adjusted2)
anova_stats(heart_rate_adjusted2)

stats::anova(heart_rate_unadjusted, heart_rate_adjusted2)

# Check residuals for normality
heart_rate_residuals_adjusted2 <- resid(heart_rate_adjusted2)
shapiro.test(heart_rate_residuals_adjusted2)
```


### 2) Resting RMSSD

Get means and sd
```{r}
describe(adolescent_data$RMSSD_msec)
describe(adolescent_data$RMSSD_msec_windsorized)

adolescent_data %>%
  group_by(group, na.rm = TRUE) %>%
  summarize(
    mean = mean(RMSSD_msec_windsorized, na.rm = TRUE),
    sd = sd(RMSSD_msec_windsorized, na.rm = TRUE)
  )
```

A) Check Model Assumptions
```{r}
# Check for homogeneity of variance
car::leveneTest(RMSSD_msec_windsorized ~ group, center = mean, data = adolescent_data)
```

B) Unadjusted Model
```{r}
# ANOVA
# Simple T-Test
t.test(RMSSD_msec_windsorized ~ group, data = adolescent_data)

# ANCOVA
rmssd_unadjusted <- aov(RMSSD_msec_windsorized ~ group, data = adolescent_data)
summary(rmssd_unadjusted)
cohens_f(rmssd_unadjusted)
anova_stats(rmssd_unadjusted)

# Check residuals for normality
rmssd_residuals_unadjusted <- resid(rmssd_unadjusted)
shapiro.test(rmssd_residuals_unadjusted)

# Plot
pirateplot(
  formula = RMSSD_msec_windsorized ~ group, # This lets you see the relationship between a categorical and continuous variables
  data = adolescent_data,
  ylab = "Resting RMSSD",
  theme = 1, pal = "google"
)

rmssd_graph <- adolescent_data %>%
  select(subject_id, group, RMSSD_msec_windsorized)

rmssd_graph <- na.omit(rmssd_graph)
mean_difference <- dabest(rmssd_graph, group, RMSSD_msec_windsorized,
       idx = c("Depressed", "Non-Depressed"),
       paired = FALSE)

plot(mean_difference)
```

C) Adjusted Model 1
```{r}
# ANCOVA
rmssd_adjusted <- aov(RMSSD_msec_windsorized ~ group + age_adol + bio_sex_adol + stimulants_med_today, data = adolescent_data)
summary(rmssd_adjusted)
cohens_f(rmssd_adjusted)
anova_stats(rmssd_adjusted)

# Check residuals for normality
rmssd_residuals_adjusted <- resid(rmssd_adjusted)
shapiro.test(rmssd_residuals_adjusted)
```

D) Adjusted Model 2
```{r}
# ANCOVA
rmssd_adjusted2 <- aov(RMSSD_msec_windsorized ~ group + age_adol + bio_sex_adol + stimulants_med_today + ysr_tot_adol_report, data = adolescent_data)
summary(rmssd_adjusted2)
cohens_f(rmssd_adjusted2)
anova_stats(rmssd_adjusted2)

# Check residuals for normality
rmssd_residuals_adjusted2 <- resid(rmssd_adjusted2)
shapiro.test(rmssd_residuals_adjusted2)
```


### 3) Resting PEP

Get means and sd
```{r}
describe(adolescent_data$PEP_msec)
describe(adolescent_data$PEP_msec_windsorized)

adolescent_data %>%
  group_by(group, na.rm = TRUE) %>%
  summarize(
    mean = mean(PEP_msec, na.rm = TRUE),
    sd = sd(PEP_msec, na.rm = TRUE)
  )
```

A) Check Model Assumptions
```{r}
# Check for homogeneity of variance
car::leveneTest(PEP_msec ~ group, center = mean, data = adolescent_data)
```

B) Unadjusted Model
```{r}
# ANOVA
# Simple T-Test
t.test(PEP_msec ~ group, data = adolescent_data)

# ANCOVA
pep_unadjusted <- aov(PEP_msec ~ group, data = adolescent_data)
summary(pep_unadjusted)
cohens_f(pep_unadjusted)
anova_stats(pep_unadjusted)

# Check residuals for normality
pep_residuals_unadjusted <- resid(pep_unadjusted)
shapiro.test(pep_residuals_unadjusted)

# Plot
pirateplot(
  formula = PEP_msec ~ group, # This lets you see the relationship between a categorical and continuous variables
  data = adolescent_data,
  ylab = "Resting PEP",
  theme = 1, pal = "google"
)

pep_graph <- adolescent_data %>%
  select(subject_id, group, PEP_msec)

pep_graph <- na.omit(pep_graph)
mean_difference <- dabest(pep_graph, group, PEP_msec,
       idx = c("Depressed", "Non-Depressed"),
       paired = FALSE)

plot(mean_difference)
```

C) Adjusted Model 1
```{r}
# ANCOVA
pep_adjusted <- aov(PEP_msec ~ group + age_adol + bio_sex_adol + stimulants_med_today, data = adolescent_data)
summary(pep_adjusted)
cohens_f(pep_adjusted)
anova_stats(pep_adjusted)

# Check residuals for normality
pep_residuals_adjusted <- resid(pep_adjusted)
shapiro.test(pep_residuals_adjusted)
```

C) Adjusted Model 2
```{r}
# ANCOVA
pep_adjusted2 <- aov(PEP_msec ~ group + age_adol + bio_sex_adol + stimulants_med_today + ysr_tot_adol_report, data = adolescent_data)
summary(pep_adjusted2)
cohens_f(pep_adjusted2)
anova_stats(pep_adjusted2)
```


### 4) Resting SCL

Get means and sd
```{r}
describe(adolescent_data$Average_SCL_uS)
describe(adolescent_data$Average_SCL_uS_windsorized)

adolescent_data %>%
  group_by(group, na.rm = TRUE) %>%
  summarize(
    mean = mean(Average_SCL_uS_windsorized, na.rm = TRUE),
    sd = sd(Average_SCL_uS_windsorized, na.rm = TRUE)
  )
```

A) Check Model Assumptions
```{r}
# Check for homogeneity of variance
car::leveneTest(Average_SCL_uS_windsorized ~ group, center = mean, data = adolescent_data)
```

B) Unadjusted Model
```{r}
# ANOVA
# Simple T-Test
t.test(Average_SCL_uS ~ group, data = adolescent_data)

# ANCOVA
scl_unadjusted <- aov(Average_SCL_uS_windsorized ~ group, data = adolescent_data)
summary(scl_unadjusted)
cohens_f(scl_unadjusted)
anova_stats(scl_unadjusted)

# Check residuals for normality
scl_residuals_unadjusted <- resid(scl_unadjusted)
shapiro.test(scl_residuals_unadjusted)

# Plot
pirateplot(
  formula = Average_SCL_uS_windsorized ~ group, # This lets you see the relationship between a categorical and continuous variables
  data = adolescent_data,
  ylab = "Resting SCL",
  theme = 1, pal = "google"
)

p <- adolescent_data %>%
  mutate(group = group) %>%
  ggplot(aes(Average_SCL_uS_windsorized, fill = group))
p + geom_density(alpha = 0.6)

scl_graph <- adolescent_data %>%
  select(subject_id, group, Average_SCL_uS_windsorized)

scl_graph <- na.omit(scl_graph)
mean_difference <- dabest(scl_graph, group, Average_SCL_uS_windsorized,
       idx = c("Depressed", "Non-Depressed"),
       paired = FALSE)

plot(mean_difference)

```

C) Adjusted Model 1
```{r}
# ANCOVA
scl_adjusted <- aov(Average_SCL_uS_windsorized ~ group + age_adol + bio_sex_adol + stimulants_med_today, data = adolescent_data)
summary(scl_adjusted)
cohens_f(scl_adjusted)
anova_stats(scl_adjusted)

# Check residuals for normality
scl_residuals_adjusted <- resid(scl_adjusted)
shapiro.test(scl_residuals_adjusted)
```

C) Adjusted Model 2
```{r}
# ANCOVA
scl_adjusted2 <- aov(Average_SCL_uS_windsorized ~ group + age_adol + bio_sex_adol + stimulants_med_today + ysr_tot_adol_report, data = adolescent_data)
summary(scl_adjusted2)
cohens_f(scl_adjusted2)
anova_stats(scl_adjusted2)

# Check residuals for normality
scl_residuals_adjusted2 <- resid(scl_adjusted2)
shapiro.test(scl_residuals_adjusted2)
```


##Mother Baseline Analyses############################################

### 1) Resting Heart Rate

Get means and sd
```{r}
describe(mother_data$Average_HR_bpm)
describe(mother_data$Average_HR_bpm_windsorized)

mother_data %>%
  group_by(group, na.rm = TRUE) %>%
  summarize(
    mean = mean(Average_HR_bpm_windsorized, na.rm = TRUE),
    sd = sd(Average_HR_bpm_windsorized, na.rm = TRUE)
  )
```

A) Check Model Assumptions
```{r}
# Check for homogeneity of variance
car::leveneTest(Average_HR_bpm_windsorized ~ group, center = mean, data = mother_data)
```

B) Unadjusted Model
```{r}
# ANOVA
# Simple T-Test
t.test(Average_HR_bpm_windsorized ~ group, data = mother_data)

# ANCOVA
heart_rate_unadjusted <- aov(Average_HR_bpm_windsorized ~ group, data = mother_data)
summary(heart_rate_unadjusted)
cohens_f(heart_rate_unadjusted)
anova_stats(heart_rate_unadjusted)

# Check residuals for normality
heart_rate_residuals_unadjusted <- resid(heart_rate_unadjusted)
shapiro.test(heart_rate_residuals_unadjusted)

# Plot
pirateplot(
  formula = Average_HR_bpm_windsorized ~ group, # This lets you see the relationship between a categorical and continuous variables
  data = mother_data,
  ylab = "Resting Heart Rate",
  theme = 1, pal = "google"
)

p <- mother_data %>%
  mutate(group = group) %>%
  ggplot(aes(Average_HR_bpm_windsorized, fill = group))
p + geom_density(alpha = 0.6)

hr_graph <- mother_data %>%
  select(subject_id, group, Average_HR_bpm_windsorized)

hr_graph <- na.omit(hr_graph)
mean_difference <- dabest(hr_graph, group, Average_HR_bpm_windsorized,
                          idx = c("Depressed", "Non-Depressed"),
                          paired = FALSE)

plot(mean_difference)
```

C) Adjusted Model
```{r}
# ANCOVA
heart_rate_adjusted <- aov(Average_HR_bpm_windsorized ~ group + age_mother + stimulants_med_today + anxiolytics_med_today + blood_pressure_med_today, data = mother_data)
summary(heart_rate_adjusted)
cohens_f(heart_rate_adjusted)
anova_stats(heart_rate_adjusted)

stats::anova(heart_rate_unadjusted, heart_rate_adjusted)

# Check residuals for normality
heart_rate_residuals_adjusted <- resid(heart_rate_adjusted)
shapiro.test(heart_rate_residuals_adjusted)
```

### 2) Resting RMSSD

Get means and sd
```{r}
describe(mother_data$RMSSD_msec)
describe(mother_data$RMSSD_msec_windsorized)

mother_data %>%
  group_by(group, na.rm = TRUE) %>%
  summarize(
    mean = mean(RMSSD_msec_windsorized, na.rm = TRUE),
    sd = sd(RMSSD_msec_windsorized, na.rm = TRUE)
  )
```

A) Check Model Assumptions
```{r}
# Check for homogeneity of variance
leveneTest(RMSSD_msec_windsorized ~ group, center = mean, data = mother_data)
```

B) Unadjusted Model
```{r}
# ANOVA
# Simple T-Test
t.test(RMSSD_msec_windsorized ~ group, data = mother_data)

# ANCOVA
rmssd_unadjusted <- aov(RMSSD_msec_windsorized ~ group, data = mother_data)
summary(rmssd_unadjusted)
cohens_f(rmssd_unadjusted)
anova_stats(rmssd_unadjusted)

# Check residuals for normality
rmssd_residuals_unadjusted <- resid(rmssd_unadjusted)
shapiro.test(rmssd_residuals_unadjusted)

# Plot
pirateplot(
  formula = RMSSD_msec_windsorized ~ group, # This lets you see the relationship between a categorical and continuous variables
  data = mother_data,
  ylab = "Resting RMSSD",
  theme = 1, pal = "google"
)

rmssd_graph <- mother_data %>%
  select(subject_id, group, RMSSD_msec_windsorized)

rmssd_graph <- na.omit(rmssd_graph)
mean_difference <- dabest(rmssd_graph, group, RMSSD_msec_windsorized,
                          idx = c("Depressed", "Non-Depressed"),
                          paired = FALSE)

plot(mean_difference)
```

C) Adjusted Model
```{r}
# ANCOVA
rmssd_adjusted <- aov(RMSSD_msec_windsorized ~ group + age_mother + stimulants_med_today + anxiolytics_med_today + blood_pressure_med_today, data = mother_data)
summary(rmssd_adjusted)
cohens_f(rmssd_adjusted)
anova_stats(rmssd_adjusted)

# Check residuals for normality
rmssd_residuals_adjusted <- resid(rmssd_adjusted)
shapiro.test(rmssd_residuals_adjusted)
```

### 3) Resting PEP

Get means and sd
```{r}
describe(mother_data$PEP_msec)
describe(mother_data$PEP_msec_windsorized)

mother_data %>%
  group_by(group, na.rm = TRUE) %>%
  summarize(
    mean = mean(PEP_msec, na.rm = TRUE),
    sd = sd(PEP_msec, na.rm = TRUE)
  )
```

A) Check Model Assumptions
```{r}
# Check for homogeneity of variance
leveneTest(PEP_msec ~ group, center = mean, data = mother_data)
```

B) Unadjusted Model
```{r}
# ANOVA
# Simple T-Test
t.test(PEP_msec ~ group, data = mother_data)

# ANCOVA
pep_unadjusted <- aov(PEP_msec ~ group, data = mother_data)
summary(pep_unadjusted)
cohens_f(pep_unadjusted)
anova_stats(pep_unadjusted)

# Check residuals for normality
pep_residuals_unadjusted <- resid(pep_unadjusted)
shapiro.test(pep_residuals_unadjusted)

# Plot
pirateplot(
  formula = PEP_msec ~ group, # This lets you see the relationship between a categorical and continuous variables
  data = mother_data,
  ylab = "Resting PEP",
  theme = 1, pal = "google"
)

pep_graph <- mother_data %>%
  select(subject_id, group, PEP_msec)

pep_graph <- na.omit(pep_graph)
mean_difference <- dabest(pep_graph, group, PEP_msec,
                          idx = c("Depressed", "Non-Depressed"),
                          paired = FALSE)

plot(mean_difference)
```

C) Adjusted Model
```{r}
# ANCOVA
pep_adjusted <- aov(PEP_msec ~ group + age_mother + stimulants_med_today + anxiolytics_med_today + blood_pressure_med_today, data = mother_data)
summary(pep_adjusted)
cohens_f(pep_adjusted)
anova_stats(pep_adjusted)

# Check residuals for normality
pep_residuals_adjusted <- resid(pep_adjusted)
shapiro.test(pep_residuals_adjusted)
```

### 4) Resting SCL

Get means and sd
```{r}
describe(mother_data$Average_SCL_uS)
describe(mother_data$Average_SCL_uS_windsorized)

mother_data %>%
  group_by(group, na.rm = TRUE) %>%
  summarize(
    mean = mean(Average_SCL_uS_windsorized, na.rm = TRUE),
    sd = sd(Average_SCL_uS_windsorized, na.rm = TRUE)
  )
```

A) Check Model Assumptions
```{r}
# Check for homogeneity of variance
leveneTest(Average_SCL_uS_windsorized ~ group, center = mean, data = mother_data)
```

B) Unadjusted Model
```{r}
# ANOVA
# Simple T-Test
t.test(Average_SCL_uS ~ group, data = mother_data)

# ANCOVA
scl_unadjusted <- aov(Average_SCL_uS_windsorized ~ group, data = mother_data)
summary(scl_unadjusted)
cohens_f(scl_unadjusted)
anova_stats(scl_unadjusted)

# Check residuals for normality
scl_residuals_unadjusted <- resid(scl_unadjusted)
shapiro.test(scl_residuals_unadjusted)

# Plot
pirateplot(
  formula = Average_SCL_uS_windsorized ~ group, # This lets you see the relationship between a categorical and continuous variables
  data = mother_data,
  ylab = "Resting SCL",
  theme = 1, pal = "google"
)

p <- mother_data %>%
  mutate(group = group) %>%
  ggplot(aes(Average_SCL_uS_windsorized, fill = group))
p + geom_density(alpha = 0.6)

scl_graph <- mother_data %>%
  select(subject_id, group, Average_SCL_uS_windsorized)

scl_graph <- na.omit(scl_graph)
mean_difference <- dabest(scl_graph, group, Average_SCL_uS_windsorized,
                          idx = c("Depressed", "Non-Depressed"),
                          paired = FALSE)

plot(mean_difference)
```

C) Adjusted Model
```{r}
# ANCOVA
scl_adjusted <- aov(Average_SCL_uS_windsorized ~ group + age_mother + stimulants_med_today + anxiolytics_med_today + blood_pressure_med_today, data = mother_data)
summary(scl_adjusted)
cohens_f(scl_adjusted)
anova_stats(scl_adjusted)

# Check residuals for normality
scl_residuals_adjusted <- resid(scl_adjusted)
shapiro.test(scl_residuals_adjusted)
```
